module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},81892,a=>{"use strict";var b=a.i(37936);a.i(70396);var c=a.i(73727),d=a.i(4135);async function e(){let a=await (0,d.createSupabaseServerClient)();await a.auth.signOut(),(0,c.redirect)("/login")}(0,a.i(13095).ensureServerEntryExports)([e]),(0,b.registerServerReference)(e,"001130e10d4eee3c57bdbe243e47dcecd75ee72810",null),a.s(["logout",()=>e])},27225,a=>{"use strict";var b=a.i(37936),c=a.i(4135),d=a.i(59019);async function e(){let a=await (0,c.createSupabaseServerClient)(),b=await (0,d.getProfile)();if(!b)throw Error("Not authenticated");let{data:e}=await a.from("items").select("*").eq("user_id",b.id).order("created_at",{ascending:!1});return e}async function f(a){let b=await (0,c.createSupabaseServerClient)(),e=await (0,d.getProfile)();if(!e)throw Error("Not authenticated");let f=a.get("name"),g=Number(a.get("quantity"));await b.from("items").insert({user_id:e.id,name:f,quantity:g})}async function g(a){let b=await (0,c.createSupabaseServerClient)(),e=await (0,d.getProfile)();if(!e)throw Error("Not authenticated");let f=a.get("csvFile");if(!f||"object"!=typeof f||!("text"in f)||!("size"in f)||"function"!=typeof f.text||"number"!=typeof f.size||0===f.size)throw Error("CSV file is required");let g=(function(a){let b=[],c=[],d="",e=!1;for(let f=0;f<a.length;f+=1){let g=a[f],h=a[f+1];if('"'===g){e&&'"'===h?(d+='"',f+=1):e=!e;continue}if(","===g&&!e){c.push(d),d="";continue}if(("\n"===g||"\r"===g)&&!e){"\r"===g&&"\n"===h&&(f+=1),c.push(d),b.push(c),c=[],d="";continue}d+=g}return(d.length>0||c.length>0)&&(c.push(d),b.push(c)),b})(await f.text()).filter(a=>a.some(a=>""!==a.trim()));if(g.length<2)throw Error("CSV must include a header and at least one row");let h=g[0].map(a=>a.trim().toLowerCase()),i=h.indexOf("name"),j=h.indexOf("quantity");if(-1===i||-1===j)throw Error("CSV must contain name and quantity columns");let k=g.slice(1).map(a=>{let b=(a[i]??"").trim(),c=Number(a[j]??"");return b&&Number.isFinite(c)&&!(c<0)?{user_id:e.id,name:b,quantity:c}:null}).filter(a=>null!==a);if(!k.length)throw Error("No valid rows found in CSV");await b.from("items").insert(k),await b.from("audit_logs").insert({actor_id:e.id,action:"IMPORTED_ITEMS",target:`${k.length} rows`})}async function h(a){let b=await (0,c.createSupabaseServerClient)(),e=await (0,d.getProfile)();if(!e||"admin"!==e.role)throw Error("Not allowed");let f=Number(a.get("id")),{data:g}=await b.from("items").select("name").eq("id",f).single();await b.from("items").delete().eq("id",f),await b.from("audit_logs").insert({actor_id:e.id,action:"DELETED_ITEM",target:g?.name??`Item ${f}`})}async function i(a){let b=await (0,c.createSupabaseServerClient)(),e=await (0,d.getProfile)();if(!e)throw Error("Not authenticated");let f=Number(a.get("id")),g=a.get("name"),h=Number(a.get("quantity"));await b.from("items").update({name:g,quantity:h}).eq("id",f),await b.from("audit_logs").insert({actor_id:e.id,action:"UPDATED_ITEM",target:`Item ${f}`})}(0,a.i(13095).ensureServerEntryExports)([e,f,g,h,i]),(0,b.registerServerReference)(e,"001418c00776d3dcf1fabd1eb0220371d7ec966730",null),(0,b.registerServerReference)(f,"409ab395cf882985090ad88d94091c700a8e05eb33",null),(0,b.registerServerReference)(g,"40bcf8930122b9e89881f990bc185d432af2dfd301",null),(0,b.registerServerReference)(h,"402ba70d10209d9fa5c36b78cfe23378d2fb5a040b",null),(0,b.registerServerReference)(i,"40b63e78d26dffe07382a6732bec3b494a64c87812",null),a.s(["addItem",()=>f,"deleteItem",()=>h,"getItems",()=>e,"importItems",()=>g,"updateItem",()=>i])},73099,a=>{"use strict";var b=a.i(81892),c=a.i(27225);a.s([],56208),a.i(56208),a.s(["001130e10d4eee3c57bdbe243e47dcecd75ee72810",()=>b.logout,"001418c00776d3dcf1fabd1eb0220371d7ec966730",()=>c.getItems,"402ba70d10209d9fa5c36b78cfe23378d2fb5a040b",()=>c.deleteItem,"409ab395cf882985090ad88d94091c700a8e05eb33",()=>c.addItem,"40b63e78d26dffe07382a6732bec3b494a64c87812",()=>c.updateItem,"40bcf8930122b9e89881f990bc185d432af2dfd301",()=>c.importItems],73099)}];

//# sourceMappingURL=_02f013f0._.js.map